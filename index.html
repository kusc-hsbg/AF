<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cute Screen Gallery + Train Layer</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jua&family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --ink:#1c1432;
      --stroke: 4px;
      --shadow: 0 18px 45px rgba(0,0,0,.18);
      --spring: cubic-bezier(.12,1.15,.3,1);

      --frameW: min(800px, 92vw);
      --frameH: min(600px, 70vh);

      --trainH: 300px;

      --sky1:#b8e8ff;
      --sky2:#c7baff;
      --sea:#163a67;
      --hill1:#41d6b3;
      --hill2:#22bfa0;
      --sun:#ffd86b;

      --frameInner:#ffffffd0;
      --btnBg:#ffffffd8;

      --car1:#ffb6d5;
      --car2:#ffe27b;
      --car3:#9ef3ff;
      --car4:#b6ffcf;
      --wheel:#2f2a46;

      --cursor-normal: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64' viewBox='0 0 64 64'%3E%3Cpath d='M14 10 L44 30 L28 34 L34 52 L28 54 L22 36 L14 42 Z' fill='white' stroke='%231c1432' stroke-width='4' stroke-linejoin='round'/%3E%3Ccircle cx='50' cy='14' r='6' fill='%23ffd86b' stroke='%231c1432' stroke-width='3'/%3E%3C/svg%3E") 6 6, auto;
      --cursor-active: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64' viewBox='0 0 64 64'%3E%3Cpath d='M10 28 C10 16 18 10 30 10 C42 10 52 18 52 30 C52 44 40 54 28 54 C16 54 10 40 10 28 Z' fill='white' stroke='%231c1432' stroke-width='4'/%3E%3Ccircle cx='24' cy='28' r='3' fill='%231c1432'/%3E%3Ccircle cx='38' cy='28' r='3' fill='%231c1432'/%3E%3Cpath d='M26 38 Q32 42 38 38' fill='none' stroke='%231c1432' stroke-width='4' stroke-linecap='round'/%3E%3C/svg%3E") 10 10, pointer;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: "Nunito", system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
      color: var(--ink);
      overflow-x:hidden;
      background: linear-gradient(180deg, var(--sky1), var(--sky2) 55%, #4a2f7c 100%);
      cursor: var(--cursor-normal);
    }
    .interactive:hover,
    .interactive:focus-visible{ cursor: var(--cursor-active); }

    /* Fixed background */
    .fixedBg{
      position:fixed; inset:0; z-index:0;
      pointer-events:none; overflow:hidden;
      background: linear-gradient(180deg, var(--sky1), var(--sky2) 55%, #4a2f7c 100%);
    }
    .fixedBg .sun{
      position:absolute; width:220px; height:220px; border-radius:999px;
      left:min(7vw, 90px); top:min(8vh, 90px);
      background: radial-gradient(circle at 35% 35%, #fff3c8 0 25%, var(--sun) 40% 100%);
      border: var(--stroke) solid rgba(0,0,0,.2);
      filter: drop-shadow(0 18px 0 rgba(0,0,0,.10));
      opacity:.95;
    }
    .fixedBg .clouds{
      position:absolute; left:-10%; right:-10%; top:8%; height:35%;
      opacity:.95;
      background:
        radial-gradient(110px 68px at 14% 34%, rgba(255,255,255,.92), transparent 70%),
        radial-gradient(150px 86px at 22% 36%, rgba(255,255,255,.86), transparent 70%),
        radial-gradient(110px 68px at 30% 34%, rgba(255,255,255,.90), transparent 70%),
        radial-gradient(120px 70px at 52% 22%, rgba(255,255,255,.86), transparent 70%),
        radial-gradient(170px 98px at 60% 24%, rgba(255,255,255,.82), transparent 70%),
        radial-gradient(120px 70px at 70% 22%, rgba(255,255,255,.86), transparent 70%),
        radial-gradient(110px 64px at 84% 34%, rgba(255,255,255,.88), transparent 70%),
        radial-gradient(150px 86px at 92% 36%, rgba(255,255,255,.84), transparent 70%),
        radial-gradient(110px 64px at 100% 34%, rgba(255,255,255,.86), transparent 70%);
      filter: drop-shadow(0 14px 0 rgba(0,0,0,.06));
    }
    .fixedBg .birds{
      position:absolute; top:20%; left:0; right:0; height:20%;
      opacity:.35;
      background:
        radial-gradient(12px 8px at 18% 40%, rgba(0,0,0,.32), transparent 60%),
        radial-gradient(12px 8px at 22% 44%, rgba(0,0,0,.28), transparent 60%),
        radial-gradient(12px 8px at 64% 30%, rgba(0,0,0,.28), transparent 60%),
        radial-gradient(12px 8px at 68% 34%, rgba(0,0,0,.26), transparent 60%),
        radial-gradient(12px 8px at 78% 44%, rgba(0,0,0,.26), transparent 60%),
        radial-gradient(12px 8px at 82% 48%, rgba(0,0,0,.24), transparent 60%);
      mix-blend-mode:multiply;
    }
    .fixedBg .hills{
      position:absolute; left:-10%; right:-10%;
      bottom:min(18vh, 190px); height:40%;
      background:
        radial-gradient(760px 320px at 12% 100%, rgba(65,214,179,.78), transparent 72%),
        radial-gradient(900px 360px at 52% 100%, rgba(34,191,160,.78), transparent 72%),
        radial-gradient(760px 320px at 88% 100%, rgba(65,214,179,.62), transparent 72%);
      filter: drop-shadow(0 18px 0 rgba(0,0,0,.10));
      opacity:.98;
    }
    .fixedBg .sea{
      position:absolute; left:-10%; right:-10%; bottom:0;
      height:min(22vh, 220px);
      background:
        radial-gradient(260px 90px at 12% 30%, rgba(255,255,255,.10), transparent 60%),
        radial-gradient(260px 90px at 42% 40%, rgba(255,255,255,.08), transparent 60%),
        radial-gradient(260px 90px at 72% 35%, rgba(255,255,255,.09), transparent 60%),
        linear-gradient(180deg, rgba(22,58,103,.55), rgba(22,58,103,1));
      border-top: var(--stroke) solid rgba(0,0,0,.18);
    }

    /* Snow layer (slightly bigger flakes) */
    .snowLayer{ position:fixed; inset:0; pointer-events:none; z-index:1; overflow:hidden; }
    .snow{
      position:absolute; top:-10px;
      width: 10px; height: 10px; /* ✅ bigger than before */
      border-radius:999px;
      background: rgba(255,255,255,.75);
      filter: drop-shadow(0 6px 0 rgba(0,0,0,.05));
      animation: snowFall linear infinite;
      opacity:.65;
    }
    @keyframes snowFall{
      from{ transform: translate3d(0,-20px,0); }
      to{ transform: translate3d(0,calc(100vh + 60px),0); }
    }

    /* Scroll zone */
    .hzone{ position:relative; z-index:2; }
    .sticky{ position:sticky; top:0; height:100vh; overflow:hidden; }

    /* Screen / Gallery */
    .screenStage{
      position:absolute; inset:0 0 var(--trainH) 0;
      display:grid; place-items:center;
      padding: 22px 0;
      z-index:4;
    }
    .screen{ width: var(--frameW); height: var(--frameH); position:relative; filter: drop-shadow(0 26px 0 rgba(0,0,0,.12)); }

    .truss{
      position:absolute; left:50%; top:-44px; transform:translateX(-50%);
      width:min(960px, 110%); height:120px;
      border-radius:999px;
      border: var(--stroke) solid rgba(0,0,0,.35);
      background: rgba(30,24,58,.55);
      box-shadow: 0 18px 0 rgba(0,0,0,.12);
      overflow:hidden; pointer-events:none;
    }
    .truss:before{
      content:""; position:absolute; inset:28px 40px auto 40px; height:50px;
      background:
        repeating-linear-gradient(60deg, rgba(255,255,255,.12) 0 10px, rgba(255,255,255,0) 10px 20px),
        repeating-linear-gradient(-60deg, rgba(255,255,255,.10) 0 10px, rgba(255,255,255,0) 10px 20px);
      opacity:.7; border-radius:999px;
    }

    .counter{
      position:absolute; top:-18px; left:50%; transform:translateX(-50%);
      padding:10px 14px; border-radius:14px;
      border: var(--stroke) solid var(--ink);
      background: rgba(255,255,255,.90);
      box-shadow: 0 12px 0 rgba(0,0,0,.12);
      font-weight:900;
      display:flex; gap:10px; align-items:center;
      z-index:7; pointer-events:none;
    }
    .counter .miniChar{
      width:28px; height:22px; border-radius:999px;
      background:#5ee6c5; border:3px solid var(--ink); position:relative;
    }
    .counter .miniChar:before,.counter .miniChar:after{
      content:""; position:absolute; width:10px; height:10px;
      background:#5ee6c5; border:3px solid var(--ink); border-radius:6px; top:-8px;
    }
    .counter .miniChar:before{ left:2px; transform:rotate(-10deg); }
    .counter .miniChar:after{ right:2px; transform:rotate(10deg); }

    /* Peek char + bubble */
    .peekWrap{
      position:absolute; left:50%; top:-84px; transform:translateX(-50%);
      z-index:8; display:flex; gap:10px; align-items:flex-end; pointer-events:auto;
    }
    .peekHead{
      width:82px; height:62px;
      border: var(--stroke) solid var(--ink); border-bottom:none;
      border-radius:36px 36px 14px 14px;
      background: rgba(255,255,255,.92);
      box-shadow: 0 12px 0 rgba(0,0,0,.12);
      position:relative; overflow:hidden;
      transform: rotate(-2deg);
    }
    .peekHead:before,.peekHead:after{
      content:""; position:absolute; width:18px; height:18px;
      border: var(--stroke) solid var(--ink);
      background: rgba(255,255,255,.92);
      border-radius:10px; top:-10px;
    }
    .peekHead:before{ left:12px; transform:rotate(-12deg); }
    .peekHead:after{ right:12px; transform:rotate(12deg); }

    .peekFace{
      position:absolute; left:50%; top:22px; transform:translateX(-50%);
      width:58px; height:34px; display:grid; place-items:center;
    }
    .peekEyes{ display:flex; gap:14px; align-items:center; margin-top:2px; }
    .peekEyes i{ width:7px; height:7px; border-radius:999px; background:var(--ink); }
    .peekMouth{
      width:18px; height:10px; border:4px solid var(--ink);
      border-top:none; border-left:none; border-right:none;
      border-radius:0 0 999px 999px; margin-top:6px;
    }

    .peekBubble{
      border: var(--stroke) solid var(--ink);
      background: rgba(255,255,255,.92);
      border-radius: 20px;
      padding: 12px 14px;
      box-shadow: 0 12px 0 rgba(0,0,0,.12);
      transform: rotate(2deg);
      max-width: min(520px, 72vw);
      position:relative;
    }
    .peekBubble:after{
      content:""; position:absolute; left:18px; bottom:-12px;
      width:18px; height:18px;
      background: rgba(255,255,255,.92);
      border: var(--stroke) solid var(--ink);
      border-right:none; border-top:none;
      transform: rotate(35deg);
      border-bottom-left-radius:8px;
    }
    .bubbleText{
      font-family:"Jua", sans-serif;
      font-size: 20px; font-weight:900;
      display:flex; flex-wrap:wrap; gap:2px; line-height:1.1;
    }
    .bubbleText span{
      display:inline-block;
      animation: bop 1.1s ease-in-out infinite;
      transform-origin: 50% 80%;
    }
    @keyframes bop{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(-6px)} }

    /* Make bubble clickable */
    .peekBubbleBtn{
      all: unset;
      display:block;
      cursor: var(--cursor-active);
      user-select:none;
    }
    .peekBubbleBtn:focus-visible{
      outline: 4px solid rgba(255,255,255,.7);
      outline-offset: 6px;
      border-radius: 14px;
    }

    .frameOuter{
      position:absolute; inset:0;
      border-radius:34px;
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(0,0,0,.08));
      border: var(--stroke) solid rgba(0,0,0,.35);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .matte{
      position:absolute; inset:16px;
      border-radius:28px;
      border: var(--stroke) solid rgba(0,0,0,.18);
      background: var(--frameInner);
      overflow:hidden;
      clip-path: polygon(0% 2%, 4% 0%, 96% 1%, 100% 4%, 99% 96%, 96% 100%, 4% 99%, 0% 96%);
    }
    .slides{
      height:100%; display:flex;
      will-change: transform;
      transition: transform 520ms var(--spring);
    }
    .slide{ flex:0 0 100%; height:100%; }
    .slide img{ width:100%; height:100%; object-fit:cover; transform:scale(1.02); display:block; }

    /* hover overlay only on matte */
    .hoverOverlay{
      position:absolute; inset:0;
      display:grid; place-items:center;
      background: rgba(255,255,255,.55);
      opacity:0; pointer-events:none;
      transition: opacity 220ms ease;
    }
    .overlayCard{
      display:grid; gap:10px; place-items:center;
      padding:16px 18px;
      border-radius:22px;
      border: var(--stroke) solid var(--ink);
      background: rgba(255,255,255,.92);
      box-shadow: 0 16px 0 rgba(0,0,0,.12);
      transform: translateY(6px) rotate(-1deg);
      transition: transform 380ms var(--spring);
    }
    .overlayTitle{ font-family:"Jua", sans-serif; font-size:22px; font-weight:900; }
    .detailBtn{
      border: var(--stroke) solid var(--ink);
      background:#fff;
      border-radius:999px;
      padding:10px 16px;
      font-family:"Jua", sans-serif;
      font-size:18px; font-weight:900;
      cursor:pointer;
      box-shadow: 0 12px 0 rgba(0,0,0,.12);
      transition: transform 220ms var(--spring);
    }
    .detailBtn:hover{ transform: translateY(-2px) scale(1.02); }
    .detailBtn:active{ transform: translateY(1px) scale(.98); }

    .matte:hover .hoverOverlay{ opacity:1; pointer-events:auto; }
    .matte:hover .overlayCard{ transform: translateY(0) rotate(.4deg) scale(1.01); }

    /* side nav */
    .sideNav{
      position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
      width:min(1120px, 96vw);
      display:flex; justify-content:space-between;
      z-index:9;
      pointer-events:none;
    }
    .navBtn{
      pointer-events:auto;
      width:58px; height:58px; border-radius:999px;
      border: var(--stroke) solid var(--ink);
      background: var(--btnBg);
      box-shadow: 0 16px 0 rgba(0,0,0,.12);
      display:grid; place-items:center;
      cursor:pointer;
      transition: transform 220ms var(--spring);
      backdrop-filter: blur(8px);
    }
    .navBtn:hover{ transform: translateY(-2px) scale(1.02); }
    .navBtn:active{ transform: translateY(1px) scale(.98); }
    .navBtn svg{ width:28px; height:28px; }

    /* =======================
       Train layer
       ======================= */
    .trainLayer{
      position:absolute; left:0; right:0; bottom:0;
      height: var(--trainH);
      z-index:3;
      pointer-events:none;
      overflow:hidden;
    }

    .trainWorld{
      position:absolute;
      inset:0;
      will-change: transform;
    }

    .trainScenery{
      position:absolute; left:-90%; right:-90%;
      bottom: 86px;
      height: 110px;
      opacity:.95;
      background:
        radial-gradient(20px 18px at 6% 62%, rgba(255,255,255,.14), transparent 60%),
        radial-gradient(30px 22px at 10% 72%, rgba(255,255,255,.10), transparent 60%),
        radial-gradient(20px 18px at 14% 64%, rgba(255,255,255,.12), transparent 60%),
        radial-gradient(30px 22px at 18% 74%, rgba(255,255,255,.10), transparent 60%),
        radial-gradient(20px 18px at 46% 66%, rgba(255,255,255,.12), transparent 60%),
        radial-gradient(30px 22px at 50% 76%, rgba(255,255,255,.10), transparent 60%),
        radial-gradient(20px 18px at 86% 66%, rgba(255,255,255,.12), transparent 60%),
        radial-gradient(30px 22px at 90% 76%, rgba(255,255,255,.10), transparent 60%),
        linear-gradient(to top, rgba(0,0,0,.18), rgba(0,0,0,0) 85%);
      filter: drop-shadow(0 12px 0 rgba(0,0,0,.08));
      will-change: transform;
    }

    .tracks{
      position:absolute; left:-90%; right:-90%; bottom:0;
      height: 94px;
      background:
        linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.30)),
        repeating-linear-gradient(90deg, rgba(255,255,255,.25) 0 22px, rgba(255,255,255,0) 22px 46px);
      border-top: var(--stroke) solid rgba(0,0,0,.35);
      opacity:.96;
    }

    .train{
      position:absolute;
      bottom: 22px;
      transform: rotate(-.2deg) scale(1.38);
      display:flex; align-items:flex-end; gap:12px;
      filter: drop-shadow(0 18px 0 rgba(0,0,0,.16));
      pointer-events:auto;
      will-change: transform;
    }

    .coupler{
      width:18px; height:10px;
      border: var(--stroke) solid var(--ink);
      border-radius:10px;
      background: rgba(255,255,255,.55);
      margin-bottom:20px;
      box-shadow: 0 10px 0 rgba(0,0,0,.10);
    }

    .car{
      height: 92px;
      border: var(--stroke) solid var(--ink);
      border-radius: 30px;
      box-shadow: 0 12px 0 rgba(0,0,0,.10);
      display:flex; align-items:center; gap:10px;
      padding: 0 14px;
      position:relative; overflow:hidden;
      background:#fff;
    }
    .car.c1{ background: linear-gradient(135deg, var(--car1), var(--car2)); width: 280px; }
    .car.c2{ background: linear-gradient(135deg, var(--car3), var(--car2)); width: 230px; }
    .car.c3{ background: linear-gradient(135deg, var(--car4), var(--car3)); width: 230px; }

    .car:before{
      content:"";
      position:absolute;
      inset:-18% -22% auto -22%;
      height:70%;
      background: radial-gradient(240px 150px at 20% 60%, rgba(255,255,255,.45), transparent 65%);
      opacity:.95;
      transform: rotate(-10deg);
    }

    .win{
      width: 46px; height: 46px;
      border: var(--stroke) solid var(--ink);
      border-radius: 18px;
      background: #b9f6ff;
      box-shadow: inset 0 9px 0 rgba(255,255,255,.55);
      position:relative; z-index:2;
    }

    .engineFace{
      width: 58px; height: 58px;
      border: var(--stroke) solid var(--ink);
      border-radius: 28px;
      background: rgba(255,255,255,.92);
      position:relative; z-index:3;
      display:grid; place-items:center;
      transition: transform 320ms var(--spring);
    }
    .engineFace .eyes{ display:flex; gap:12px; margin-top:2px; }
    .engineFace .eyes i{ width:7px; height:7px; border-radius:999px; background:var(--ink); }
    .engineFace .cheek{
      position:absolute; width:10px; height:10px; border-radius:999px;
      background: rgba(255,120,183,.55); bottom: 15px;
    }
    .engineFace .cheek.left{ left:11px; }
    .engineFace .cheek.right{ right:11px; }
    .engineFace .mouth{
      width:18px; height:10px;
      border:4px solid var(--ink);
      border-top:none; border-left:none; border-right:none;
      border-radius:0 0 999px 999px;
      margin-top:6px;
    }
    .engineFace .wink{
      position:absolute; opacity:0;
      left:50%; top:24px; transform:translateX(-50%);
      width:32px; height:10px;
      border-bottom:4px solid var(--ink);
      border-radius:0 0 999px 999px;
    }
    .engineFace:hover{ transform: translateY(-4px) rotate(2deg); }
    .engineFace:hover .eyes{ opacity:0; }
    .engineFace:hover .wink{ opacity:1; }
    .engineFace:hover .mouth{ transform: scaleX(1.1); }

    .animal{
      width: 50px; height: 40px;
      border: var(--stroke) solid var(--ink);
      border-radius: 24px;
      background: rgba(255,255,255,.90);
      position:relative; z-index:2;
      display:grid; place-items:center;
      transform: rotate(var(--r));
      transition: transform 320ms var(--spring);
    }
    .animal:before,.animal:after{
      content:""; position:absolute; width:12px; height:12px;
      border: var(--stroke) solid var(--ink);
      background: rgba(255,255,255,.90);
      border-radius: 8px; top: -10px;
    }
    .animal:before{ left:7px; transform: rotate(-10deg); }
    .animal:after{ right:7px; transform: rotate(10deg); }
    .faceA,.faceB{ position:absolute; display:flex; gap:6px; transition: opacity 220ms ease; }
    .faceA i,.faceB i{ width:6px; height:6px; border-radius:999px; background:var(--ink); }
    .faceB{ opacity:0; }
    .faceB:after{
      content:"";
      width:16px; height:8px;
      border:4px solid var(--ink);
      border-top:none; border-left:none; border-right:none;
      border-radius:0 0 999px 999px;
      margin-left:6px;
      transform: translateY(3px);
    }
    .animal:hover{ transform: translateY(-4px) rotate(calc(var(--r) + 6deg)) scale(1.05); }
    .animal:hover .faceA{ opacity:0; }
    .animal:hover .faceB{ opacity:1; }

    .label{
      font-family:"Jua", sans-serif;
      font-size: 18px; font-weight:900;
      position:relative; z-index:2;
    }

    .heartBadge{
      position:absolute; right:10px; top:10px;
      width:22px; height:22px;
      border:3px solid var(--ink);
      border-radius:8px;
      background: rgba(255,255,255,.70);
      z-index:4;
      display:grid; place-items:center;
      transform: rotate(6deg);
      box-shadow: 0 8px 0 rgba(0,0,0,.10);
    }
    .heartBadge span{
      width:10px; height:10px;
      background:#ff78b7;
      transform: rotate(45deg);
      position:relative; border-radius:2px;
    }
    .heartBadge span:before,.heartBadge span:after{
      content:""; position:absolute; width:10px; height:10px;
      border-radius:999px; background:#ff78b7; top:-5px;
    }
    .heartBadge span:before{ left:-5px; }
    .heartBadge span:after{ left:5px; }

    .wheels{
      position:absolute; left:18px; right:18px;
      bottom:-22px;
      display:flex; justify-content:space-between;
      z-index:2;
    }
    .wheel{
      width:32px; height:32px;
      border: var(--stroke) solid var(--ink);
      border-radius:999px;
      background: var(--wheel);
      box-shadow: inset 0 4px 0 rgba(255,255,255,.10);
      animation: spin .9s linear infinite;
    }
    @keyframes spin{ from{transform:rotate(0)} to{transform:rotate(360deg)} }

    .chimney{
      position:absolute; left:22px; top:-18px;
      width:26px; height:24px;
      border: var(--stroke) solid var(--ink);
      border-radius:10px;
      background: rgba(255,255,255,.90);
      box-shadow: 0 10px 0 rgba(0,0,0,.10);
      z-index:3;
    }
    .smoke{
      position:absolute; left:10px; top:-54px;
      width:74px; height:54px;
      opacity:.78;
      background:
        radial-gradient(18px 18px at 22% 70%, rgba(255,255,255,.90), transparent 65%),
        radial-gradient(22px 22px at 44% 52%, rgba(255,255,255,.86), transparent 65%),
        radial-gradient(18px 18px at 62% 70%, rgba(255,255,255,.88), transparent 65%);
      filter: drop-shadow(0 10px 0 rgba(0,0,0,.06));
      z-index:2;
      will-change: transform;
      transition: transform 160ms linear;
      pointer-events:none;
    }

    /* =======================
       Full view overlay
       ======================= */
    .fullView{
      position:fixed;
      inset:0;
      z-index:20;
      display:none;
      background: rgba(18,12,40,.55);
      backdrop-filter: blur(10px);
    }
    .fullView.is-open{ display:block; }

    .fullPanel{
      position:absolute;
      left:50%; top:50%;
      transform: translate(-50%,-50%);
      width: min(980px, 92vw);
      max-height: min(82vh, 760px);
      overflow:auto;
      border: var(--stroke) solid var(--ink);
      border-radius: 28px;
      background: rgba(255,255,255,.92);
      box-shadow: 0 26px 70px rgba(0,0,0,.28);
      padding: 18px;
    }
    .fullTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      margin-bottom: 12px;
    }
    .fullTitle{
      font-family:"Jua", sans-serif;
      font-size: 22px;
      font-weight:900;
      display:flex;
      align-items:center;
      gap: 10px;
    }
    .pill{
      padding: 6px 10px;
      border-radius: 999px;
      border: 3px solid var(--ink);
      background: rgba(255,255,255,.85);
      font-weight:900;
      font-size: 14px;
    }

    .backBtn, .bgmBtn{
      border: var(--stroke) solid var(--ink);
      background: #fff;
      border-radius: 999px;
      padding: 10px 14px;
      font-family:"Jua", sans-serif;
      font-size: 16px;
      font-weight:900;
      cursor:pointer;
      box-shadow: 0 12px 0 rgba(0,0,0,.12);
      transition: transform 220ms var(--spring);
      user-select:none;
    }
    .backBtn:hover,.bgmBtn:hover{ transform: translateY(-2px) scale(1.02); }
    .backBtn:active,.bgmBtn:active{ transform: translateY(1px) scale(.98); }

    .grid{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 12px;
    }
    @media (max-width: 860px){
      .grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    @media (max-width: 520px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      border: 3px solid rgba(0,0,0,.20);
      border-radius: 18px;
      overflow:hidden;
      background: rgba(255,255,255,.85);
      box-shadow: 0 12px 0 rgba(0,0,0,.10);
      transition: transform 220ms var(--spring);
    }
    .card:hover{ transform: translateY(-3px) rotate(.3deg); }
    .card img{
      width:100%;
      height: 180px;
      object-fit:cover;
      display:block;
    }
    .cardCap{
      padding: 10px 10px 12px;
      font-weight:900;
    }

    /* reduce motion */
    @media (prefers-reduced-motion: reduce){
      .slides{ transition:none !important; }
      .bubbleText span{ animation:none !important; }
      .snow{ animation:none !important; }
      .wheel{ animation:none !important; }
    }
  </style>
</head>

<body>
  <div class="fixedBg" aria-hidden="true">
    <div class="sun"></div>
    <div class="clouds"></div>
    <div class="birds"></div>
    <div class="hills"></div>
    <div class="sea"></div>
  </div>

  <div class="snowLayer" id="snowLayer" aria-hidden="true"></div>

  <!-- BGM audio (provide your own file) -->
  <audio id="bgm" src="assets/bgm.mp3" loop preload="auto"></audio>

  <section class="hzone" id="hzone">
    <div class="sticky">

      <div class="screenStage">
        <div class="screen" id="screen">
          <div class="truss"></div>

          <div class="peekWrap interactive" aria-label="전체보기 열기">
            <div class="peekHead">
              <div class="peekFace">
                <div class="peekEyes"><i></i><i></i></div>
                <div class="peekMouth"></div>
              </div>
            </div>

            <div class="peekBubble">
              <button class="peekBubbleBtn interactive" id="openFullBtn" type="button" aria-label="전체보기 열기">
                <div class="bubbleText" id="bubbleText"></div>
              </button>
            </div>
          </div>

          <div class="counter">
            <span class="miniChar"></span>
            <span id="counterText">1 / 5</span>
          </div>

          <div class="frameOuter">
            <div class="matte interactive" id="matte" tabindex="0">
              <div class="slides" id="slides"></div>

              <div class="hoverOverlay">
                <div class="overlayCard">
                  <div class="overlayTitle" id="overlayTitle">자세히 보기</div>
                  <button class="detailBtn interactive" id="detailBtn" type="button">자세히 알아보기</button>
                </div>
              </div>
            </div>
          </div>

          <div class="sideNav" aria-label="갤러리 이동 버튼">
            <button class="navBtn interactive" id="prev" aria-label="이전 (왼쪽)" type="button">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M14.5 5L7.5 12L14.5 19" stroke="#1c1432" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>

            <button class="navBtn interactive" id="next" aria-label="다음 (오른쪽)" type="button">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M9.5 5L16.5 12L9.5 19" stroke="#1c1432" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <div class="trainLayer" aria-hidden="false">
        <div class="trainWorld" id="trainWorld">
          <div class="trainScenery" id="trainScenery"></div>

          <div class="train" id="train">
            <div class="car c1">
              <div class="smoke" id="smoke"></div>
              <div class="chimney"></div>

              <div class="engineFace interactive" title="기관차">
                <span class="cheek left"></span>
                <span class="cheek right"></span>
                <div class="eyes"><i></i><i></i></div>
                <div class="wink"></div>
                <div class="mouth"></div>
              </div>

              <div class="win"></div>
              <div class="label">GO!</div>
              <div class="heartBadge"><span></span></div>

              <div class="wheels">
                <div class="wheel"></div><div class="wheel"></div><div class="wheel"></div>
              </div>
            </div>

            <div class="coupler"></div>

            <div class="car c2">
              <div class="animal interactive" style="--r:5deg;" title="동물 친구">
                <div class="faceA"><i></i><i></i></div>
                <div class="faceB"><i></i></div>
              </div>
              <div class="win"></div>
              <div class="label">DINO</div>
              <div class="heartBadge"><span></span></div>

              <div class="wheels">
                <div class="wheel"></div><div class="wheel"></div><div class="wheel"></div>
              </div>
            </div>

            <div class="coupler"></div>

            <div class="car c3">
              <div class="animal interactive" style="--r:-4deg;" title="동물 친구">
                <div class="faceA"><i></i><i></i></div>
                <div class="faceB"><i></i></div>
              </div>
              <div class="win"></div>
              <div class="label">FRIENDS</div>
              <div class="heartBadge"><span></span></div>

              <div class="wheels">
                <div class="wheel"></div><div class="wheel"></div><div class="wheel"></div>
              </div>
            </div>
          </div>

          <div class="tracks"></div>
        </div>
      </div>

    </div>
  </section>

  <!-- Full view overlay -->
  <div class="fullView" id="fullView" role="dialog" aria-modal="true" aria-label="전체보기">
    <div class="fullPanel">
      <div class="fullTop">
        <div class="fullTitle">
          <span class="pill">전체보기</span>
          <span id="fullCount">5장</span>
        </div>
        <div style="display:flex; gap:10px; align-items:center;">
          <button class="bgmBtn interactive" id="bgmBtn" type="button" aria-label="BGM 토글">BGM ▶</button>
          <button class="backBtn interactive" id="backBtn" type="button" aria-label="이전">(이전)</button>
        </div>
      </div>
      <div class="grid" id="grid"></div>
    </div>
  </div>

  <script>
    // =========================
    // DATA
    // =========================
    const DATA = [
      { src:"assets/img-01.jpg", fallback:"https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=1600&q=60", title:"Daesang", bubbleTitle:"Daesang", link:"#detail-1" },
      { src:"assets/img-02.jpg", fallback:"https://images.unsplash.com/photo-1520975682049-33d7a612b4d0?auto=format&fit=crop&w=1600&q=60", title:"Scene 02", bubbleTitle:"Scene 02", link:"#detail-2" },
      { src:"assets/img-03.jpg", fallback:"https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1600&q=60", title:"Scene 03", bubbleTitle:"Scene 03", link:"#detail-3" },
      { src:"assets/img-04.jpg", fallback:"https://images.unsplash.com/photo-1518837695005-2083093ee35b?auto=format&fit=crop&w=1600&q=60", title:"Scene 04", bubbleTitle:"Scene 04", link:"#detail-4" },
      { src:"assets/img-05.jpg", fallback:"https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=1600&q=60", title:"Scene 05", bubbleTitle:"Scene 05", link:"#detail-5" },
    ];

    // Elements
    const slidesEl = document.getElementById("slides");
    const hzone = document.getElementById("hzone");
    const counterText = document.getElementById("counterText");
    const overlayTitle = document.getElementById("overlayTitle");
    const detailBtn = document.getElementById("detailBtn");
    const bubbleTextEl = document.getElementById("bubbleText");

    const prevBtn = document.getElementById("prev");
    const nextBtn = document.getElementById("next");

    const trainWorld = document.getElementById("trainWorld");
    const trainScenery = document.getElementById("trainScenery");
    const smoke = document.getElementById("smoke");
    const train = document.getElementById("train");

    // Full view
    const fullView = document.getElementById("fullView");
    const grid = document.getElementById("grid");
    const backBtn = document.getElementById("backBtn");
    const openFullBtn = document.getElementById("openFullBtn");
    const fullCount = document.getElementById("fullCount");

    // BGM
    const bgm = document.getElementById("bgm");
    const bgmBtn = document.getElementById("bgmBtn");
    let bgmEnabled = false;

    let currentIndex = 0;

    function clamp(n,a,b){ return Math.max(a, Math.min(b,n)); }

    function buildSlides(){
      slidesEl.innerHTML = "";
      DATA.forEach((d) => {
        const slide = document.createElement("div");
        slide.className = "slide";
        slide.innerHTML = `<img src="${d.src}" alt="${d.title}" onerror="this.src='${d.fallback}'; this.onerror=null;">`;
        slidesEl.appendChild(slide);
      });
    }

    function buildGrid(){
      grid.innerHTML = "";
      fullCount.textContent = `${DATA.length}장`;
      DATA.forEach((d, i) => {
        const card = document.createElement("button");
        card.type = "button";
        card.className = "card interactive";
        card.style.all = "unset";
        card.style.display = "block";
        card.style.cursor = "var(--cursor-active)";
        card.innerHTML = `
          <div class="card">
            <img src="${d.src}" alt="${d.title}" onerror="this.src='${d.fallback}'; this.onerror=null;">
            <div class="cardCap">${i+1}. ${d.title}</div>
          </div>
        `;
        card.addEventListener("click", () => {
          closeFullView();
          scrollToIndex(i);
        });
        grid.appendChild(card);
      });
    }

    // Bubble letters
    function setBouncyBubbleText(text){
      bubbleTextEl.innerHTML = "";
      [...text].forEach((ch, i) => {
        const s = document.createElement("span");
        s.textContent = ch === " " ? "\u00A0" : ch;
        s.style.animationDelay = `${i * 0.06}s`;
        bubbleTextEl.appendChild(s);
      });
    }

    // half scroll per page
    const STEP = () => Math.max(220, Math.round(window.innerHeight * 0.5));

    function setupHeight(){
      const total = (DATA.length - 1) * STEP() + window.innerHeight;
      hzone.style.height = `${total}px`;
      applyIndex(currentIndex, false);
      syncUI();
      layoutTrainBounds();
    }

    function applyIndex(idx, animate=true){
      currentIndex = clamp(idx, 0, DATA.length - 1);

      if(!animate) slidesEl.style.transition = "none";
      const matte = document.getElementById("matte");
      const w = matte.getBoundingClientRect().width;
      slidesEl.style.transform = `translate3d(${-currentIndex * w}px,0,0)`;
      if(!animate) requestAnimationFrame(() => slidesEl.style.transition = "");

      counterText.textContent = `${currentIndex + 1} / ${DATA.length}`;
    }

    function zoneTopAbs(){
      return window.scrollY + hzone.getBoundingClientRect().top;
    }

    function scrollToIndex(idx){
      const target = clamp(idx, 0, DATA.length - 1);
      const y = zoneTopAbs() + target * STEP();
      window.scrollTo({ top: y, behavior: "smooth" });
    }

    function syncUI(){
      overlayTitle.textContent = DATA[currentIndex]?.bubbleTitle ?? "자세히 보기";
      detailBtn.onclick = () => {
        const href = DATA[currentIndex]?.link ?? "#";
        window.location.href = href;
      };
      setBouncyBubbleText("한번에 볼래요?");
    }

    function scrollProgress(){
      const rect = hzone.getBoundingClientRect();
      const total = hzone.offsetHeight - window.innerHeight;
      return clamp((0 - rect.top) / (total || 1), 0, 1);
    }

    // =========================
    // Train movement: left edge -> right edge
    // =========================
    let trainMinX = 0;
    let trainMaxX = 0;

    function layoutTrainBounds(){
      const layer = document.querySelector(".trainLayer");
      if(!layer || !train) return;

      const layerRect = layer.getBoundingClientRect();
      const trainRect = train.getBoundingClientRect();

      // The train element is scaled; we want its visible width.
      const trainW = trainRect.width;

      // place left edge at 0 + small padding, right edge at layer width - trainW - padding
      const pad = 18;
      trainMinX = pad;
      trainMaxX = Math.max(pad, layerRect.width - trainW - pad);

      // ensure we set an initial position
      const t = scrollProgress();
      const x = trainMinX + (trainMaxX - trainMinX) * t;
      train.style.left = "0px";          // we will transform translateX only
      train.style.transform = `translate3d(${x}px,0,0) rotate(-.2deg) scale(1.38)`;
    }

    function onScroll(){
      const rect = hzone.getBoundingClientRect();
      const local = clamp((0 - rect.top), 0, hzone.offsetHeight - window.innerHeight);

      const idx = Math.round(local / STEP());
      if(idx !== currentIndex){
        applyIndex(idx, true);
        syncUI();
      }

      const t = scrollProgress();

      // ✅ train position from left edge to right edge
      const x = trainMinX + (trainMaxX - trainMinX) * t;
      train.style.transform = `translate3d(${x}px,0,0) rotate(-.2deg) scale(1.38)`;

      // scenery runs faster (still tied to scroll)
      trainWorld.style.transform = `translate3d(${t*240}px,0,0)`;
      trainScenery.style.transform = `translate3d(${t*1200}px,0,0)`;

      // smoke wobble
      const puff = Math.sin(t * Math.PI * 8) * 4;
      smoke.style.transform = `translate3d(${puff}px,${-6 + (puff*0.2)}px,0)`;
    }

    // =========================
    // Full view open/close
    // =========================
    function openFullView(){
      fullView.classList.add("is-open");
      buildGrid();
      // start BGM on first real user interaction (allowed)
      tryStartBgm();
    }
    function closeFullView(){
      fullView.classList.remove("is-open");
      tryStartBgm();
    }

    openFullBtn.addEventListener("click", openFullView);
    backBtn.addEventListener("click", closeFullView);

    // Close full view on overlay click (outside panel)
    fullView.addEventListener("click", (e) => {
      if(e.target === fullView) closeFullView();
    });

    // =========================
    // BGM
    // =========================
    async function tryStartBgm(){
      if(!bgm) return;
      if(bgmEnabled) return; // already started intentionally
      // We only start when user has interacted (this function is called from clicks)
      try{
        bgm.volume = 0.22;
        await bgm.play();
        bgmEnabled = true;
        bgmBtn.textContent = "BGM ❚❚";
      }catch(err){
        // autoplay blocked; user can start via button
        bgmBtn.textContent = "BGM ▶";
      }
    }

    bgmBtn.addEventListener("click", async () => {
      if(!bgm) return;
      try{
        if(bgm.paused){
          bgm.volume = 0.22;
          await bgm.play();
          bgmEnabled = true;
          bgmBtn.textContent = "BGM ❚❚";
        }else{
          bgm.pause();
          bgmBtn.textContent = "BGM ▶";
        }
      }catch(e){
        bgmBtn.textContent = "BGM ▶";
      }
    });

    // Buttons + keyboard
    prevBtn.addEventListener("click", () => { tryStartBgm(); scrollToIndex(currentIndex - 1); });
    nextBtn.addEventListener("click", () => { tryStartBgm(); scrollToIndex(currentIndex + 1); });

    window.addEventListener("keydown", (e) => {
      if(fullView.classList.contains("is-open")){
        if(e.key === "Escape") closeFullView();
        return;
      }
      if(e.key === "ArrowLeft")  scrollToIndex(currentIndex - 1);
      if(e.key === "ArrowRight") scrollToIndex(currentIndex + 1);
    });

    // Snow init
    function initSnow(){
      const layer = document.getElementById("snowLayer");
      const count = 16;
      for(let i=0;i<count;i++){
        const d = document.createElement("div");
        d.className = "snow";
        const size = 7 + Math.random()*6; // ✅ slightly bigger than before
        d.style.width = `${size}px`;
        d.style.height = `${size}px`;
        d.style.left = `${Math.random()*100}%`;
        d.style.opacity = (0.35 + Math.random()*0.35).toFixed(2);
        const dur = 7 + Math.random()*8;
        d.style.animationDuration = `${dur}s`;
        d.style.animationDelay = `${Math.random()*-dur}s`;
        layer.appendChild(d);
      }
    }

    // Init
    buildSlides();
    initSnow();
    setupHeight();
    syncUI();
    onScroll();

    window.addEventListener("resize", () => {
      setupHeight();
      layoutTrainBounds();
      onScroll();
    }, { passive:true });

    window.addEventListener("scroll", onScroll, { passive:true });
  </script>
</body>
</html>
